@using FilmReview.Models
@using FilmReview.Data
@using Microsoft.EntityFrameworkCore
<img src="@FilmsAndData.Film.FilmImageLink" />
@{
    float result =(float)FilmsAndData.Film.Summ / (float)FilmsAndData.Film.Total;
}
<h1>@result </h1>
<h4>О фильме: @FilmsAndData.Film.About</h4>
<h5>Страна: @FilmsAndData.Film.Country | Год: @FilmsAndData.Film.Year </h5>
<h5>Длительность: @FilmsAndData.Film.Duration | MPAA: @FilmsAndData.Film.MPAA </h5>
@if (FilmsAndData.isAdmin != null)
{
    <Blazorise.Rating Color="Color.Primary" @bind-SelectedValue="@FilmsAndData.Rank" MaxValue="5" />
<button @onclick="RateFilm">Rate</button>
}

@code {
    public int[] array = new int[5];
    [Parameter]
    public FilmsAndData FilmsAndData { get; set; }
    [Inject]
    private MyContext _context{ get; set; }
    private async Task RateFilm()
    {
        if (FilmsAndData.Rank > 0 && FilmsAndData.Rank < 6)
        {
            Reviews review = new Reviews();
            review.UserID = (int)FilmsAndData.currentUserID;
            review.FilmID = FilmsAndData.Film.FilmID;
            review.Rank =(int)FilmsAndData.Rank;
            if (FilmsAndData.ReviewID != null)
            {
                review.ReviewID = (int)FilmsAndData.ReviewID;
                _context.Reviews.Update(review);
            }
            else
                _context.Reviews.Add(review);
            await _context.SaveChangesAsync();
            }
    }
}
